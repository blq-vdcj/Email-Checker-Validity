import openpyxl
import re

# Charger le fichier Excel
fichier = "email.xlsx"  # Nom du fichier
wb = openpyxl.load_workbook(fichier)
sheet = wb.active

# Fonction pour vérifier la validité des adresses e-mail
def est_email_valide(email):
    motif = r"^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$"
    
    # Vérifier si l'e-mail correspond au motif et s'il n'a pas deux points consécutifs à la fin
    if re.match(motif, email) and not email.endswith(".."):
        return True
    return False

# Vérifier toutes les lignes de la colonne A
for row in range(1, sheet.max_row + 1):
    cellule = f"A{row}"
    email = sheet[cellule].value
    if email:
        validité = "Valide" if est_email_valide(email) else "Invalide"
        sheet[f"B{row}"] = validité  # Écrire le résultat dans la colonne B

# Sauvegarder les résultats dans un nouveau fichier
wb.save("resultat_verification.xlsx")
